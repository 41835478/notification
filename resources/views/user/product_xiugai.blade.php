<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head lang="en">
<meta charset="UTF-8">
<title>蘑菇云-两岸特产网-发布产品</title>
<link rel="stylesheet" href="/manager/css/bootstrap.min.css">
<link rel="stylesheet" href="/manager/css/base.css">
<link rel="stylesheet" href="/manager/css/main.css">
<script type="text/javascript" src="/js/sea.js"></script>
<script type="text/javascript" src="/js/sea_config.js"></script>
<script charset="utf-8" async="" src="/js/jquery.min.js"></script>
<script charset="utf-8" async="" src="/js/product.js"></script>
<script charset="utf-8" async="" src="/js/product_Marquee.js"></script>
<script charset="utf-8" async="" src="/js/jqueryzoom.js"></script>
<script charset="utf-8" async="" src="/js/jquery.cookie.js"></script>
<script charset="utf-8" async="" src="/js/district.js"></script>
<script type="text/javascript" charset="gbk" src="/Houtai/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="gbk" src="/Houtai/ueditor/ueditor.all.min.js"> </script>
<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
<script type="text/javascript" charset="gbk" src="/Houtai/ueditor/lang/zh-cn/zh-cn.js"></script>
<body>
<!------------公用头部 start------------>
<div id="topnav">
  <div class="main clearfix">
    <div class="login-info"> 欢迎回来 , 中国天妖 ！<a href="/user/index/logout.html" class="login">退出</a> </div>
    <ul class="login-menu">
      <li><a href="#">联系客服</a></li>
      <li class="line"></a></li>
      <li><a href="/help/index/index.html">帮助中心</a></li>
    </ul>
  </div>
</div>
<!--头部-->
<div id="header">
  <div class="main">
    <h1><a title="特产网" href="/"></a></h1>
  </div>
</div>
<div id="nav">
  <div class="main clearfix fs-16 text-white"> <i></i> 我的电商分销平台 </div>
</div>
<!------------公用头部 end------------>
 <link type="text/css" rel="stylesheet" href="/manager/css/fabugongying.css" />
<link type="text/css" rel="stylesheet" href="/manager/css/user_center.css" />

<!------------主体 start------------>
<div class="main">
<!--左侧导航  start-->
  <div class="main-left fl fs-14 clearfix">

    <h3 class="item fs-14"><i class="myhome"></i>我的微店铺	</h3>
    <ul>
      <li><a href="/user/seller/index.html"><i class="ico-1"></i>分销商管理</a></li>
      <li><a href="/user/cloud/index.html"><i class="ico-2"></i>微店产品库</a></li>
      <li><a href="/user/order/index.html"><i class="ico-3"></i>订单管理</a></li>
      <li><a href="/user/product_list"><i class="ico-4"></i>我的供应</a></li>
      <li><a href="/user/auth/index.html"><i class="ico-16"></i>我的认证</a></li>
      <li><a href="/user/auth/authsupply.html"><i class="ico-16"></i>供应商认证</a></li>
      <div class="cl"></div>
    </ul>
    <!--
          <li><a href="shop.html"><i class="ico-1"></i>分销商管理</a></li>
      <li><a href="shop-1.html"><i class="ico-2"></i>云端产品库</a></li>
      <li><a href="shop-2.html"><i class="ico-3"></i>订单管理</a></li>
      <li><a href="shop-3.html"><i class="ico-4"></i>我的供应</a></li>


      user/supply_publish/index
      user/supply_order/index
      user/supply_info/qq
      user/supply_info/address
     -->

<!--     <h3 class="item fs-14"><i class="ydh"></i>我的广告</h3>
    <ul >
      <li><a href="/user/nav/index.html"><i class="ico-5"></i>导航能赚钱</a></li>
      <li><a href="/user/nav/position.html"><i class="ico-6"></i>我要拍位置</a></li>
    </ul> -->
    <h3 class="item fs-14"><i class="money"></i>财富中心</h3>
    <ul>
      <li><a href="/user/money/index.html"><i class="ico-7"></i>余额动态</a></li>
      <li><a href="/user/tradecom/index.html"><i class="ico-8"></i>我的佣金</a></li>
      <li><a href="/user/auth_com/index.html"><i class="ico-8"></i>认证佣金</a></li>

      <li><a href="/user/return/index.html"><i class="ico-9"></i>购物退款</a></li>
      <li><a href="/user/supply_money/index.html"><i class="ico-10"></i>货物管理</a></li>
      <li><a href="/user/supply_deposit/index.html"><i class="ico-11"></i>供应商保证金</a></li>
    </ul>
    <h3 class="item fs-14"><i class="person"></i>个人资料</h3>
    <ul>
      <li><a href="/user/info/index.html"><i class="ico-12"></i>基本资料</a></li>
      <li><a href="/user/info/password.html"><i class="ico-13"></i>修改密码</a></li>
      <li><a href="/user/info/bank.html"><i class="ico-14"></i>银行信息</a></li>
      <li><a href="/user/info/address.html"><i class="ico-15"></i>收货信息</a></li>

      <!--
            <li><a href="person.html"><i class="ico-12"></i>基本资料</a></li>
      <li><a href="person-1.html"><i class="ico-13"></i>修改密码</a></li>
      <li><a href="person-2.html"><i class="ico-14"></i>银行信息</a></li>
      <li><a href="person-3.html"><i class="ico-15"></i>收货信息</a></li>
       -->
    </ul>
    <h3 class="item fs-14"><i class="ydpro"></i><a href="/shop/cloud/index.html">云端产品库</a></h3>
  </div>

  <!--左侧导航  end-->

  <div class="main-right fr clearfix">
    <div class="content CIndiBg">
   		<div class="CIndi">
            <div class="CIndiInner">
                <div class="CIndiInnerR">
                    <div class="rs">

                    <form id="product_form" method="post" action="/user/product_xiugai_tijiao?product_id={{$product_xinxi->id}}">
                    	<input type="hidden" name="_token" value="{{ csrf_token() }}" />
                    	<input type="hidden" name="dianpu_id" value="{{$product_xinxi->dianpu_id}}" />
                    	<div class="rscla">
                        	<dl>
                            	<dt><span>*</span>&nbsp;选择分类：</dt>
                                <dd class="clat1">
                                    <input type="hidden" name="cid" id="cid" value="0" />
                                    <label class="clatxt1" onclick="showProductCate();" id="cate_name">{{$fenlei}}</label>
                                </dd>

                            </dl>


                            <dl>
                                    <dt><span>*</span>&nbsp;商品所在地：</dt>
                                    <dd class="rscdd1">
                                <select class="ReceInfoSel ReceInfoSel1" name="localarea_province" id="province">

                                </select>
                                <select class="ReceInfoSel" name="localarea_city" id="city">

                                </select>
                                <select class="ReceInfoSel" name="localarea_area" id="area">

                                </select>
                                </dd>
                            </dl>

                            <dl>
                            	<dt><span>*</span>&nbsp;产品标题：</dt>
                                <dd class="clat1"><input type="text" class="clatxt1" name="title" value="{{$product_xinxi->title}}"/></dd>
                            </dl>
                           
                            <dl>
                            	<dt><span>*</span>&nbsp;关键词：</dt>
                                @foreach($keyword as $keyword)
                                <dd class="clat3"><input type="text" class="clatxt3" name="keywords[]" value="{{$keyword}}"/></dd>
                                @endforeach
                                <dd class="clat4"><a href="javascript:void(0)" id="add_keywords_btn" style="color:#4167AC;">新增关键词</a></dd>
                            </dl>
                        </div>
                        <div class="rscla">
                        	<div class="rst"><span>*</span>&nbsp;产品属性：</div>
                            <div class="rsc">
                                <div id="attr_tpl_list">
                                @foreach($shuxing as $shuxing)
                                <dl>
                                	<dd class="rscdd4"><input type="text" class="rsctxt1" placeholder="属性名称" name="tmp_attr_key[]" value="{{$shuxing['shuxing_key']}}"/></dd>
                                    <dd class="rscdd5"><span>：&nbsp;</span><input type="text" class="rsctxt2" placeholder="属性值" name="tmp_attr_val[]" value="{{$shuxing['shuxing_val']}}"/></dd>
                                </dl>
                                @endforeach
                                </div>
                                <dl>
                                	<dd class="clat4 clat4Mar"><a href="javascript:void(0)" id="add_attr_val_btn">添加自定义属性</a></dd>
                                </dl>
                            </div>
                        </div>
    					<div class="rscla">
    						<div class="rst"><span>*</span>&nbsp;上传图片：</div>
                            <ul class="upload_picture">
                              @foreach($picture as $picture)
                              <li><img src="{{$picture}}"  width="150px" style="height:100px;"/><p><a href="/user/product_picture_delete?picture_filename={{$picture}}" target="upload_picture">删除</a></p></li>
                              @endforeach
                            </ul>
                        </div>
                        <iframe name="upload_picture" width="0" height="0"></iframe> 
                          <iframe src="/user/product_picture" id="pictureframe" scrolling="yes" frameborder="0" width="1000" height="250"></iframe>

                        <div class="rscla">
                        	<div class="rst"><span>*</span>&nbsp;<strong>运费设定：</strong><input type="text" style="border: 1px solid #DADADA;height: 26px;padding: 0 0 0 7px;line-height: 26px;color: #AAA;" name="yunfei" value="{{$product_xinxi->yunfei}}"/></div>
                        </div>
                        <div class="rscla">
                        	<div class="upload_color">
                                <h2>
                                    <font style="color: Red;">*</font><font style="font-weight:700; color:#333;">价格标题：</font><input type="text" style="border: 1px solid #DADADA;height: 26px;padding: 0 0 0 7px;line-height: 26px;color: #AAA;" id="txtys" name="jiage_title" value="{{$product_xinxi->jiage_title}}">
                                </h2>
                                <div id="price_list">
                                	 <dl>
                                         <dd class="clat4"><a href="javascript:void(0)" id="add_price" style="color:#4167AC;">新增种类、价格</a></dd>
                                     </dl>
                                     @foreach($jiage as $jiage)
                                     <dl>
                                        <font style="font-weight:700; color:#333; float:left; line-height:28px;.font-size:15px; margin-left:1em;">1、种类：</font>
                                        <dd class="clat3"><input type="text" class="clatxt3" placeholder="输入种类" name="jiage_zhonglei[]" value="{{$jiage['jiage_zhonglei']}}"/></dd>
                                        <dd class="clat3"><input type="text" class="clatxt3" placeholder="对应价格" name="jiage_price[]" value="{{$jiage['jiage_price']}}"/></dd>
                                        <dd class="clat3"><input type="text" class="clatxt3" placeholder="库存量" name="jiage_kucun[]" value="{{$jiage['jiage_kucun']}}"/></dd>
                                    </dl>
                                    @endforeach
                               </div> 
                            </div>
                        </div>
                        <div class="rscla clabor">
                        	<div class="rst">详细描述：</div>
                            <div class="editor">
                                  <script id="editor" type="text/plain" style="width:802px;height:300px;float:left;" name="detail">{!!$product_xinxi->detail!!}</script>
									<script type="text/javascript">
                                    //实例化编辑器
                                    //建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
                                    var ue = UE.getEditor('editor');
                                
                                
                                    function isFocus(e){
                                        alert(UE.getEditor('editor').isFocus());
                                        UE.dom.domUtils.preventDefault(e)
                                    }
                                    function setblur(e){
                                        UE.getEditor('editor').blur();
                                        UE.dom.domUtils.preventDefault(e)
                                    }
                                    function insertHtml() {
                                        var value = prompt('插入html代码', '');
                                        UE.getEditor('editor').execCommand('insertHtml', value)
                                    }
                                    function createEditor() {
                                        enableBtn();
                                        UE.getEditor('editor');
                                    }
                                    function getAllHtml() {
                                        alert(UE.getEditor('editor').getAllHtml())
                                    }
                                    function getContent() {
                                        var arr = [];
                                        arr.push("使用editor.getContent()方法可以获得编辑器的内容");
                                        arr.push("内容为：");
                                        arr.push(UE.getEditor('editor').getContent());
                                        alert(arr.join("\n"));
                                    }
                                    function getPlainTxt() {
                                        var arr = [];
                                        arr.push("使用editor.getPlainTxt()方法可以获得编辑器的带格式的纯文本内容");
                                        arr.push("内容为：");
                                        arr.push(UE.getEditor('editor').getPlainTxt());
                                        alert(arr.join('\n'))
                                    }
                                    function setContent(isAppendTo) {
                                        var arr = [];
                                        arr.push("使用editor.setContent('欢迎使用ueditor')方法可以设置编辑器的内容");
                                        UE.getEditor('editor').setContent('欢迎使用ueditor', isAppendTo);
                                        alert(arr.join("\n"));
                                    }
                                    function setDisabled() {
                                        UE.getEditor('editor').setDisabled('fullscreen');
                                        disableBtn("enable");
                                    }
                                
                                    function setEnabled() {
                                        UE.getEditor('editor').setEnabled();
                                        enableBtn();
                                    }
                                
                                    function getText() {
                                        //当你点击按钮时编辑区域已经失去了焦点，如果直接用getText将不会得到内容，所以要在选回来，然后取得内容
                                        var range = UE.getEditor('editor').selection.getRange();
                                        range.select();
                                        var txt = UE.getEditor('editor').selection.getText();
                                        alert(txt)
                                    }
                                
                                    function getContentTxt() {
                                        var arr = [];
                                        arr.push("使用editor.getContentTxt()方法可以获得编辑器的纯文本内容");
                                        arr.push("编辑器的纯文本内容为：");
                                        arr.push(UE.getEditor('editor').getContentTxt());
                                        alert(arr.join("\n"));
                                    }
                                    function hasContent() {
                                        var arr = [];
                                        arr.push("使用editor.hasContents()方法判断编辑器里是否有内容");
                                        arr.push("判断结果为：");
                                        arr.push(UE.getEditor('editor').hasContents());
                                        alert(arr.join("\n"));
                                    }
                                    function setFocus() {
                                        UE.getEditor('editor').focus();
                                    }
                                    function deleteEditor() {
                                        disableBtn();
                                        UE.getEditor('editor').destroy();
                                    }
                                    function disableBtn(str) {
                                        var div = document.getElementById('btns');
                                        var btns = UE.dom.domUtils.getElementsByTagName(div, "button");
                                        for (var i = 0, btn; btn = btns[i++];) {
                                            if (btn.id == str) {
                                                UE.dom.domUtils.removeAttributes(btn, ["disabled"]);
                                            } else {
                                                btn.setAttribute("disabled", "true");
                                            }
                                        }
                                    }
                                    function enableBtn() {
                                        var div = document.getElementById('btns');
                                        var btns = UE.dom.domUtils.getElementsByTagName(div, "button");
                                        for (var i = 0, btn; btn = btns[i++];) {
                                            UE.dom.domUtils.removeAttributes(btn, ["disabled"]);
                                        }
                                    }
                                
                                    function getLocalData () {
                                        alert(UE.getEditor('editor').execCommand( "getlocaldata" ));
                                    }
                                
                                    function clearLocalData () {
                                        UE.getEditor('editor').execCommand( "clearlocaldata" );
                                        alert("已清空草稿箱")
                                    }
                                </script>
                            </div>
                            <div class="rslist">
                            	<dl>
                                    <dt><span>*</span>&nbsp;有效期：&nbsp;</dt>
                                    <dd class="listrdo"><input type="radio" name="expiry" checked="checked" value="10" /></dd>
                                    <dd class="listt">10天</dd>
                                    <dd class="listrdo"><input type="radio" name="expiry" value="20"/></dd>
                                    <dd class="listt">20天</dd>
                                    <dd class="listrdo"><input type="radio" name="expiry" value="30"/></dd>
                                    <dd class="listt">1个月</dd>
                                    <dd class="listrdo"><input type="radio" name="expiry" value="90"/></dd>
                                    <dd class="listt">3个月</dd>
                                    <dd class="listrdo"><input type="radio" name="expiry" value="180"/></dd>
                                    <dd class="listt">6个月</dd>
                                </dl>
                                <div class="listRel"><span id="add_product_btn">发布</span></div>
                                <p class="error"><font color="#FF0000">提示：{{$error or '请填写所有内容在提交'}}</font></p>
                            </div>
                        </div>
                    </form>

                     </div>
                </div>
            </div>
        </div>
    </div>
	    <div id="product_cate" class="mydiv procla">
        <p><span class="s1">产品分类</span><span class="s2" onclick="javascript:closeProductCate();"></span></p>
        <ul>
    @foreach ($all_lanmu as $all_lanmu)
            <li>
                <p>{{$all_lanmu['dingji']}}</p>
                <dl>
					@if(!empty($all_lanmu['erji']))
                    @for($i=0;$i<count($all_lanmu['erji']);$i++)
                    <dd><a href="javascript:void(0)" data="{{$all_lanmu['erji_id'][$i]}}">{{$all_lanmu['erji'][$i]}}</a></dd>
                    @endfor
                    @endif
                 </dl>
          </li>
@endforeach      
      </ul>
    </div>
<!--弹出层发布供应产品分类开始-->
<script language="javascript" type="text/javascript">
seajs.use(['app','user','postage','price','district'],function(app,user,postage,price,district) {
    //绑定省份城市关联下拉框 district
    district.init('#province','#city','#area');
    district.bind('{{$product_xinxi->didian1}}','{{$product_xinxi->didian2}}','{{$product_xinxi->didian3}}');

	//post提交
	$('#add_product_btn').click(function(){
		$('#product_form').submit();
	})
	//按删除移除图片
   $('.upload_picture li').click(function(){
	  num = $(this).index();
	  $('.upload_picture li:eq('+num+')').remove();
	})
	//分类选择
    $('#product_cate a').click(function() {
        var top_cate = $(this).parent().parent().prev().html();
        var curr_cate = $(this).html();
        var cid = $(this).attr('data');
        $('#cid').val(cid);
        $('#cate_name').html(top_cate+' > '+curr_cate);
        closeProductCate();
    });
    //新增关键词
    $('#add_keywords_btn').click(function() {
        var key = '<dd class="clat3"><input type="text" class="clatxt3" name="keywords[]"/></dd>';
        var parent = $(this).parent();
        parent.before(key);
    });
    //添加自定义属性
    $('#add_attr_val_btn').click(function() {
        var tpl = '<dl>\
                        <dd class="rscdd4"><input type="text" class="rsctxt1" placeholder="属性名称" name="tmp_attr_key[]"/></dd>\
                        <dd class="rscdd5"><span>：&nbsp;</span><input type="text" class="rsctxt2" placeholder="属性值" name="tmp_attr_val[]"/></dd>\
                    </dl>';
        var parent = $(this).parent().parent().prev();
        $(parent).append(tpl);

    }); 
});
//新增种类、价格
var i=1;
$('#add_price').click(function(){
	i = i+1;
   var neirong = '<dl>\
					<font style="font-weight:700; color:#333; float:left; line-height:28px;.font-size:15px; margin-left:1em;">'+i+'、种类：</font>\
					<dd class="clat3"><input type="text" class="clatxt3" placeholder="输入种类" name="jiage_zhonglei[]"/></dd>\
					<dd class="clat3"><input type="text" class="clatxt3" placeholder="对应价格" name="jiage_price[]"/></dd>\
                    <dd class="clat3"><input type="text" class="clatxt3" placeholder="库存量" name="jiage_kucun[]"/></dd>\
				</dl>'; 
      $('#price_list').append(neirong);
})
//显示商城分类
function showProductCate(){
    $('#product_cate').show();
    $('#bg').show();
}
function closeProductCate(){
    $('#product_cate').hide();
    $('#bg').hide();
}
//属性模板
function call_add_attr_tpl(attr) {
   $('#attr_tpl_select').append('<option value="'+attr.id+'">'+attr.name+'</option>');
   $('#tmp_attr_name').val('');
   closeSave();
}
function call_get_attr_tpl(attr) {
   var tpl = '';
    for(var i in attr.option) {
        tpl += '<dl>';
        for(var key in attr.option[i]) {
            tpl += '<dd class="rscdd4"><input type="text" class="rsctxt1" placeholder="属性名称" name="tmp_attr_key[]" value="'+key+'"/></dd>';
            tpl += '<dd class="rscdd5"><span>：&nbsp;</span><input type="text" class="rsctxt2" placeholder="属性值" name="tmp_attr_val[]" value="'+attr.option[i][key]+'"/></dd>';
        }
        tpl += '</dl>';
    }
    $('#attr_tpl_list').html(tpl);
}
</script>
	</div>
</div>
</body>
</html>
<script type="text/javascript" src="/manager/js/jquery-1.7.2.js"></script>
<script>
$(function(){
		 $(".a_block1 .rad1").click(function(){
		  if($(this).attr("value")=="1"){
				$("#agricultural").show();}
		  else{
			$("#agricultural").hide();
		  }
		  });

		  $(".a_block2 .rad2").click(function(){
		  if($(this).attr("value")=="1"){
				$("#newresource").show();}
		  else{
			$("#newresource").hide();
		  }
		  });
		 
		  $(".a_block3 .rad3").click(function(){
		  if($(this).attr("value")=="1"){
				$("#oldbrand").show();}
		  else{

			$("#oldbrand ").hide();
		  }
		  }); 									 
	});
</script>